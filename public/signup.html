<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">

<head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-156554032-1"></script>
<script>
 window.dataLayer = window.dataLayer || [];
 function gtag(){dataLayer.push(arguments);}
 gtag('js', new Date());

 gtag('config', 'UA-156554032-1');
</script>

   <title>Online Diary/journal</title>
   <meta charset="utf-8" />
   <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
   <meta http-equiv="refresh" />
   
   <meta name="description" content="The number one free journal and diary with 100% privacy and is available offline." />
   
   <meta name="keywords" content="online diary, online journal, free diary with total privacy, online bible study tool, group bible study" />
   
   <meta name="author" content="Geoffrey Kibera Ngure" />
   
   <script data-ad-client="ca-pub-6607329542714309" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

   <!--bootstrap-->
   <link rel="stylesheet" type="text/css" href="./boot/bootstrap.min.css" />
   <link rel="stylesheet" type="text/css" href="./boot/bootstrap-grid.min.css" />
   <link rel="stylesheet" type="text/css" href="./boot/bootstrap-reboot.min.css" />

   <!--normal css-->
    <link rel="stylesheet" type="text/css" href="./css/footer.css" />
    <link rel="stylesheet" type="text/css" href="./css/main.css" />
    <link rel="stylesheet" type="text/css" href="./css/actions.css" />

   <!--favicon-->
   <link rel="apple-touch-icon" sizes="57x57" href="./favicon/apple-icon-57x57.png" />
   <link rel="apple-touch-icon" sizes="60x60" href="./favicon/apple-icon-60x60.png" />
   <link rel="apple-touch-icon" sizes="72x72" href="./favicon/apple-icon-72x72.png" />
   <link rel="apple-touch-icon" sizes="76x76" href="./favicon/apple-icon-76x76.png" />
   <link rel="apple-touch-icon" sizes="114x114" href="./favicon/apple-icon-114x114.png" />
   <link rel="apple-touch-icon" sizes="120x120" href="./favicon/apple-icon-120x120.png" />
   <link rel="apple-touch-icon" sizes="144x144" href="./favicon/apple-icon-144x144.png" />
   <link rel="apple-touch-icon" sizes="152x152" href="./favicon/apple-icon-152x152.png" />
   <link rel="apple-touch-icon" sizes="180x180" href="./favicon/apple-icon-180x180.png" />
   <link rel="icon" type="image/png" sizes="192x192" href="./favicon/android-icon-192x192.png" />
   <link rel="icon" type="image/png" sizes="32x32" href="./favicon/favicon-32x32.png" />
   <link rel="icon" type="image/png" sizes="96x96" href="./favicon/favicon-96x96.png" />
   <link rel="icon" type="image/png" sizes="16x16" href="./favicon/favicon-16x16.png" />

   <meta name="msapplication-TileColor" content="#00ffaa" />
   <meta name="msapplication-TileImage" content="./favicon/ms-icon-144x144.png" />
   <meta name="theme-color" content="#ccffee" />

   <link rel="manifest" href="manifest.json" />

   <script type="text/javascript" src="./scripts/widgEditor.js"></script>

   <!--fonts-->
   <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Bangers|Roboto+Mono|Indie+Flower&display=swap">
   
</head>

<body>   
    
    <div style=" margin-top: 30px;">
       </div>

    
    <div class="container-fluid">
        <div class="row" style="margin-top: 25px; width: 100%;">
            <div class="col-sm-10 offset-sm-1 col-12 flexible">
                <div class="card">
                    <div class="card-body">
                        <h4 class="card-title">Please enter your details to have an account...</h4>
                        <img src="./images/diary144.png" style="width:20%; height: auto;" alt="online diary logo" />
                        
                        <p id="response" style="color: green;"></p>
                        
                        
                        <form action="https://finitecreations.co.ke/api/" method="post" role="form" onSubmit="return signedup(this)" >
                            <div class="form-group">
                                <input type="text" name="firstname" class="form-control col-sm-6 col-md-5 mx-auto" placeholder="First name" />
                            </div>
                            <div class="form-group">
                                <input type="text" name="surname" class="form-control col-sm-6 col-md-5 mx-auto" placeholder="Surname" />
                            </div>
                            <div class="form-group">
                                <p id="userup" class="" ></p>
                                <p id="badresponse" style="color: red;"></p>
                                <input type="text" id="username" name="username" class="form-control col-sm-6 col-md-5 mx-auto" placeholder="username" />
                            </div>
                            <div class="form-group">
                                <input type="text" name="email" class="form-control col-sm-6 col-md-5 mx-auto" placeholder="Email" />
                            </div>
                            <div class="form-group">
                                <input id="password" type="password" name="password" class="form-control col-sm-6 col-md-5 mx-auto" placeholder="Password" />
                            </div>
                            <div class="form-group">
                                <input id="cpassword" type="password" name="cpassword" class="form-control col-sm-6 col-md-5 mx-auto" placeholder="Confirm password" />
                            </div>
                    
                            <div class="form-group">
                                <input type="submit" name="signup" value="SIGNUP" class="btn btn-confirm btn-block col-sm-6 col-md-5 mx-auto" />
                            </div>
                        </form> 
                
                        <br />
                        
                        <p class="card-text">Have an account? <a href="/login">Log in...</a></p>
                    </div>

                </div>
            </div>
        </div>
        
        
        <div class="row">
            <div class="col-sm-12">
                
                <br />
                <h5></h5>
                <hr />
    
	           
                
            </div>
        </div>
    </div>
    <a href="/onlinelogin" id="onlinelogin"></a>
     
	<div id="footer" style="position:fixed; bottom:0;">
        <small>
            copyright &copy; 2020 | 
            <a href="https://finitecreations.co.ke"> powered by finite creations</a>
        </small>
    </div>

	<script type="text/javascript" src="./scripts/validator.js"></script>
    <script type="text/javascript" src="./scripts/indexedDB.js" ></script>
    <script type="text/javascript" src="./scripts/jquery.min.js"></script>
    <script type="text/javascript" src="./scripts/sha1encryption.js"></script>
    <script type="text/javascript">
        $(document).ready(function(){
            //https://finitecreations.co.ke/api/
            $("#username").blur(function(){
                var data={
                    username: $(this).val(),
                    usernameC: 'CONFIRM USERNAME'
                }
                
                fetch("https://finitecreations.co.ke/api/", {
                    method: 'POST',
                    headers: new Headers({'content-type': "application/json"}),
                    body: JSON.stringify(data)
                }).then(res=>{
                    return res.json();
                }).then(res=>{
                    console.log(res);
                    if(res.value=="error"){
                        if($("#userup").hasClass("userno")){
                            $("#userup").removeClass("userno");
                        }
                        $("#userup").addClass("useryes");
                        data="username available";
                        $("#badresponse").html("");
                    } 
                    if(res.value=="success"){
                        if($("#userup").hasClass("useryes")){
                            $("#userup").removeClass("useryes");
                        }
                        $("#userup").addClass("userno");
                        data="username already taken. Please select another username";
                    }
                    
                    $("#userup").html(data);
                }).catch(err=>{
                    console.log(err);
                });            
            });
        });

        function signedup(form){

            var signupdata={
                firstname: form.firstname.value,
                surname: form.surname.value,
                username: form.username.value,
                email: form.email.value,
                password: form.password.value,
                cpassword: form.cpassword.value,
                signup: form.signup.value
            }
        
            var fail="";
            fail = validateFirstname(form.firstname.value);
            fail += validateSurname(form.surname.value);
            fail += validateUsername(form.username.value);
            fail += validateEmail(form.email.value);
            fail += validatePassword2(form.password.value, form.cpassword.value);

            if(fail==""){
                console.log("fetching");
                fetch('https://finitecreations.co.ke/api/', {
                    method: 'POST',
                    headers: new Headers({'content-type': "application/json"}),
                    body: JSON.stringify(signupdata)
                }).then(res=>{
                    return res.json();
                }).then(res=>{
                    console.log(res);
                    if(res.value==="success"){
                        $("#response").html("SUCESS! Redirecting...");
                        $("#badresponse").html("");
                        //$("#onlinelogin").trigger('click');
                        window.location.href="/login";
                    }else{
                        $("#badresponse").html("username taken");
                        $("#response").html("");
                    }
                    
                }).catch(err=>{
                    $("#badresponse").html("error from server");
                   console.log(err); 
                });
            }else{
                alert(fail); 
                
            }
            return false;
        }

    function displayMessage(msg){
        alert(msg);
    }

    if(navigator.online){
	 	console.log("you are online");
	}else{
	 	console.log("you are offline");
	}
    </script>
	
</body>
</html>


    
    
    
    
    