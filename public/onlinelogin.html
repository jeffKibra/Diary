<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-156554032-1"></script>
<script>
 window.dataLayer = window.dataLayer || [];
 function gtag(){dataLayer.push(arguments);}
 gtag('js', new Date());

 gtag('config', 'UA-156554032-1');
</script>

   <title>Online Diary/journal</title>
   <meta charset="utf-8" />
   <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
   <meta http-equiv="refresh" />
   
   <meta name="description" content="The number one free journal and diary with 100% privacy and is available offline." />
   
   <meta name="keywords" content="online diary, online journal, free diary with total privacy, online bible study tool, group bible study" />
   
   <meta name="author" content="Geoffrey Kibera Ngure" />
   
   <script data-ad-client="ca-pub-6607329542714309" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

   <!--bootstrap-->
   <link rel="stylesheet" type="text/css" href="./boot/bootstrap.min.css" />
   <link rel="stylesheet" type="text/css" href="./boot/bootstrap-grid.min.css" />
   <link rel="stylesheet" type="text/css" href="./boot/bootstrap-reboot.min.css" />

   <!--normal css-->
    <link rel="stylesheet" type="text/css" href="./css/footer.css" />
    <link rel="stylesheet" type="text/css" href="./css/main.css" />
    <link rel="stylesheet" type="text/css" href="./css/actions.css" />

   <!--favicon-->
   <link rel="apple-touch-icon" sizes="57x57" href="./favicon/apple-icon-57x57.png" />
   <link rel="apple-touch-icon" sizes="60x60" href="./favicon/apple-icon-60x60.png" />
   <link rel="apple-touch-icon" sizes="72x72" href="./favicon/apple-icon-72x72.png" />
   <link rel="apple-touch-icon" sizes="76x76" href="./favicon/apple-icon-76x76.png" />
   <link rel="apple-touch-icon" sizes="114x114" href="./favicon/apple-icon-114x114.png" />
   <link rel="apple-touch-icon" sizes="120x120" href="./favicon/apple-icon-120x120.png" />
   <link rel="apple-touch-icon" sizes="144x144" href="./favicon/apple-icon-144x144.png" />
   <link rel="apple-touch-icon" sizes="152x152" href="./favicon/apple-icon-152x152.png" />
   <link rel="apple-touch-icon" sizes="180x180" href="./favicon/apple-icon-180x180.png" />
   <link rel="icon" type="image/png" sizes="192x192" href="./favicon/android-icon-192x192.png" />
   <link rel="icon" type="image/png" sizes="32x32" href="./favicon/favicon-32x32.png" />
   <link rel="icon" type="image/png" sizes="96x96" href="./favicon/favicon-96x96.png" />
   <link rel="icon" type="image/png" sizes="16x16" href="./favicon/favicon-16x16.png" />

   <meta name="msapplication-TileColor" content="#00ffaa" />
   <meta name="msapplication-TileImage" content="./favicon/ms-icon-144x144.png" />
   <meta name="theme-color" content="#ccffee" />

   <link rel="manifest" href="manifest.json" />

   <script type="text/javascript" src="./scripts/widgEditor.js"></script>

   <!--fonts-->
   <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Bangers|Roboto+Mono|Indie+Flower&display=swap">
   
</head>

<body>
    
    <div style=" margin-top: 30px;">
       </div>

    
    
    <div class="container-fluid">
        <div class="row" style="margin-top: 25px; width: 100%;">
            <div class="col-sm-10 offset-sm-1 col-12 flexible">
                <div class="card">
                    <div class="card-body">
                        <h4 class="card-title">Please login to continue...</h4>
                        <h6>this is the online login page. Ensure that you are online... <a href="/login">offline login?</a></h6>
                        <img src="./images/diary144.png" style="width:20%; height: auto;" alt="online diary logo" />
                        
                        <p id="loginmessage"></p>
                        <!--//https://finitecreations.co.ke/api/-->
                        
                        <form action="https://finitecreations.co.ke/api/" method="post" role="form" onSubmit="return logedin(this)" >
                            <div class="form-group">
                                <input type="text" name="username" class="form-control col-sm-6 col-md-5 mx-auto" placeholder="username" />
                            </div>
                            <div class="form-group">
                                <input type="password" name="password" class="form-control col-sm-6 col-md-5 mx-auto" placeholder="Password" />
                            </div>
                            <div class="form-group">
                                <input type="submit" name="login" value="LOGIN" class="btn btn-confirm btn-block col-sm-6 col-md-5 mx-auto" />
                            </div>
                        </form>
                        <br />
                        
                        <p>Do not have an account? <a href="signup">Sign up...</a>
                    </div>

                </div>
            </div>
        </div>
        
    </div>
	
	<div id="footer" style="position:fixed; bottom:0;">
        <small>
            copyright &copy; 2020 | 
            <a href="http://finitecreations.co.ke"> powered by finite creations</a>
        </small>
    </div>

    <script type="text/javascript" src="./scripts/validator.js"></script>
    <script type="text/javascript" src="./scripts/indexedDB.js" ></script>
    <script type="text/javascript" src="./scripts/jquery.min.js"></script>
    <script type="text/javascript" src="./scripts/sha1encryption.js"></script>
    <script type="text/javascript" >
        
        $(document).ready(function(){            
            setInterval(loader, 2000);
        });
        
        function loader(){//check if the fields have values before redirecting
            var id=localStorage.getItem('permanentId');
            var username=localStorage.getItem('permanentUsername');
            if(id !== null && username !== null){
                window.location.href="/login";
            }
        }
        
        function logedin(form){
            var logindata={
                username: form.username.value,
                password: form.password.value,
                submit: form.login.value
            }
            console.log(logindata);
        
            var fail="";
            fail = validateUsername(form.username.value);
            fail += validatePassword(form.password.value);
            //fail += validateSurname(form.subject.value);

            if(fail==""){///userlogin
                fetch("https://finitecreations.co.ke/api/", {
				    method:'POST',
					headers:new Headers({'content-type':'application/json'}),
					body:JSON.stringify(logindata)
				}).then(response=>{
                    if(response.status!==200){
                        throw "There was an error communicating to the server.\n Please try agin later.";
                    }
                    return response.json();
                    
				}).then(response=>{
                    if(response.value=="no"){
                        //console.log(response.value);
                        $("#loginmessage").html("Invalid username or password");
                        
                    }
                    if(response.id!==""){//add details to indexeddb
                        $("#loginmessage").html("login successful");
                        permanentWriter(response);
                        //window.location.href=response;
                    }
                    //console.log(response);     
                }).catch(err=>{
                    
                         console.log("an error occurred");   
                    //dbReader(logindata);
                    //dbWriter("message", mess1);
                    console.log(err);
					
                });
                   		
            }else{
                alert(fail); 
            
            }
        return false;
    }

        
        

        
    function displayMessage(msg){
        alert(msg);
    }

    if(navigator.online){
	 	console.log("you are online");
	}else{
	 	console.log("you are offline");
	}
    </script>
	
</body>
</html>




    
    
    
    
    
